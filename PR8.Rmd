---
title: "Практическая работа 8"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
library("forecast")
```

Возьмем для анализа временной ряд LakeHuron.

Данные содержат информацию об уровне озера с 1875 по 1972 года.

```{r}
lh <- LakeHuron
is.ts(lh)
lh
```

Выводем временной график с помощью функции plot() или ts.plot().

```{r}
ts.plot(lh, gpars=list(xlab="day", ylab="sales", lty=c(1:3)))
```

Вычислим функции автокоррелляции (acf) и частную автокоррелляционную функцию (pacf) и построим их коррлеллограммы.

```{r}
acf(lh)
pacf(lh)
```

Построим для ряда lh трендовую модель с помощью функции StrutTS.

```{r}
lh.st <- StructTS(lh, type = "trend")
lh.st
```

Выполним подгонку полученных значений с помощью функции fitted.

```{r}
fitted(lh.st)
```

Построим диаграмму компонент.

```{r}
plot(fitted(lh.st),col = "red")
```

Получим диагностику полученной модели. Она отображает значения остатков, их АКФ и уровни значимости для различных лагов.

```{r}
tsdiag(lh.st)
```

Получим прогноз последующих уровней и их стандартных ошибок с помощью функции predict.

```{r}
predict(lh.st, n.ahead = 10)
```

Теперь ыыполним подгонку AR-модели различными методами. 

Будут выводиться оцененные коэффициенты модели в количестве в соответствии с порядком (order), установленным по критерию Акаике, а также предсказанные значения уровней и стандартные ошибки.

Метод Юла-Уолкера (yule-walker)

```{r}
lh.arw<-ar(lh) # Defaults method = "yule-walker".
lh.arw
predict(lh.arw,n.ahead = 10)
```

Метод наименьших квадратов (ols).

```{r}
lh.ar<-ar(lh, method="ols")
lh.ar
predict(lh.ar,n.ahead = 10)
```

Метод Бурга (burg)

```{r}
lh.arb<-ar(lh, method="burg")
lh.arb
predict(lh.arb,n.ahead = 10)
```

Сравнивая полученные результаты можно отметить, что предсказанные значения отличаются незначиательно, а наименьшая ошибка получена при использованиии метода наименьших квадратов и метода Бурга.

Выполним подгонку модели ARIMA.

Чтобы не определять значение параметров arima самостоятельно воспользуемся функцией auto.arima из пакета forecast.

```{r}
lh.arima <- auto.arima(lh)
lh.arima
```

Выполним диагностику модели с графическим выводом.

```{r}
tsdiag(lh.arima)
```

- Диаграмма остатков соответствует белому шуму (случайная ошибка);
- Автокорреляция остатков убывает;
- p-значения не превышают 0,05 - следовательно, модель авторегрессии значима

Получим предсказание уровней ряда и их стандартных ошибок.

```{r}
predict(lh.arima, n.ahead=10, se.fit = TRUE)
```

