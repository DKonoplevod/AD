---
title: "**Практическая работа 3**"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
```

Файл данных npk содержит классический факторный эксперимент по оценке урожайности гороха при различных типах удобрений N, P, K (азот, фосфат, калий) и их комбинаций на 6 блоках (участках).
Выведем полученные данные.

```{r}
print(npk)
```

Проведем дисперсинный анализ с помозью функции aov, включив в модель block и факторы N, P, K.

```{r}
options(contrasts = c("contr.sum", "contr.poly"))
npk.aov <- aov(yield ~ block + N*P*K, npk)
npk.aov
summary(npk.aov)
```
  
Итоговая таблица показывает статистическую значимость фактора N (p=0.00437), K (p=0.02880) и block (p=0.01594).

```{r}
coef(npk.aov)
```

Теперь применим линейную модель. При этом в модель будем включать только факторы N, K и block, так как только они являются статистически значимыми.

```{r}
options(contrasts = c("contr.treatment", "contr.poly"))
npk.aov1 <- aov(yield ~ block + N + K, data = npk)
summary.lm(npk.aov1)
```

Таблица коэффициентов интерпретируется следующим образом:

- для базового уровня средняя оценка урожанойности - 53.208 с высокой значимостью;
- для уровня N1 средняя оценка урожайности увеличивается;
- для уровня N1 средняя оценка урожайности уменьшается с меньшей значимостью;
- для block3 средняя оценка урожайности также увеличивается с меньшей значимостью.

Значимость модели в целом достаточна - p=0.001805.

```{r}
se.contrast(npk.aov1, list(N=="0", N=="1"), data = npk)
model.tables(npk.aov1, type = "means", se = TRUE)
```

## Вывод

 На основании выборочного исследования урожайности гороха при различных типах удобрений N, P, K (азот, фосфат, калий) и их комбинаций на 6 блоках(участках) установлено:

1. Статистически значимое влияние типа удобрения N (азот) - Pr(>F)=0.00437, причем добавление азота способствует увеличению урожайности;
2. Влияние типа удобрения P(фосфат) не является статистически значимым - Pr(>F)=0.47490;
3. Влияние типа удобрения K(калий) можно считать значимым, но с меньшей надежностью - Pr(>F)=0.02880;
4. Влияние фактора блока(участка) также является значимым, но с меньшей надежностью - Pr(>F)=0.01594;
5. Влияние взаимодействия различных типов удорений не является значимым
